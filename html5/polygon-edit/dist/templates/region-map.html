<svg id="map" draggable draggable-ondrag="mapDrag()" draggable-onclick="mapClick()">
  <g id="canvas" ng-attr-transform="translate({{zoom.x}},{{zoom.y}}) scale({{zoom.scale}})">
    <g id="map_pathes">
      <g ng-repeat="pref in data.prefs.list" ng-class="pref.name">
        <path ng-repeat="region in pref.regions"
          ng-class="{selected : region.isSelected}"
          ng-attr-d="{{region.path}}"
          fill="{{pref.color}}"/>
      </g>
    </g>

    <g id="selected_polygon" ng-show="data.selectedRegion.polygon">
      <g ng-show="data.selectedRegion.polygon.isClose">
        <line ng-repeat="l in data.selectedRegion.polygon.lines"
          ng-attr-x1="{{l.d1.x}}" ng-attr-y1="{{l.d1.y}}"
          ng-attr-x2="{{l.d2.x}}" ng-attr-y2="{{l.d2.y}}"/>
      </g>
      <polyline
        ng-show="!data.selectedRegion.polygon.isClose"
        ng-attr-points="{{data.selectedRegion.polygon.toPoints()}}"
        stroke-width="{{1 / zoom.scale}}"/>
      <circle ng-repeat="dot in data.selectedRegion.polygon.dots"
        ng-attr-cx="{{dot.x}}"
        ng-attr-cy="{{dot.y}}"
        ng-attr-r="{{5 / zoom.scale}}"/>
    </g>
  </g>
</svg>
